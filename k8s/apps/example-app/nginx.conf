server {
    listen 8080;
    server_name _;

    root /usr/share/nginx/html;
    index index.html;

    # Serve static content
    location / {
        try_files $uri $uri/ /index.html;
    }

    # Expose auth headers as JSON for JavaScript to consume
    location /headers {
        default_type application/json;
        return 200 '{"X-Auth-Request-User":"$http_x_auth_request_user","X-Auth-Request-Email":"$http_x_auth_request_email","X-Auth-Request-Preferred-Username":"$http_x_auth_request_preferred_username"}';
    }

    # Health check endpoint
    location /healthz {
        access_log off;
        return 200 "OK\n";
        add_header Content-Type text/plain;
    }
}
